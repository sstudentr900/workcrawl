<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
  </head>
  <body>
    <h2>nvm 切換 Node.js 版本</h2>
    <p>請切記要安裝一個 Node.js 版本(請選用LTS版本)，不然你寫的程式會沒有可以運行的環境</p>
    <pre class="prettyprint">
      <xmp>
        //安裝特定 Node.js 版本
        nvm install [version]

        //nvm install 12.19.0

        //切換 Node.js 版本
        nvm use [version]

        //列出本機(local)已經安裝好的 Node.js 版本
        nvm list

        //顯示當下 Node.js 版本
        nvm current
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10238321">nvm 官網</a>
      </li>
    </ul>
    <hr>

    <h2>git gitignore 忽略清單</h2>
    <p>新增.gitignore檔</p>
    <pre class="prettyprint">
      <xmp>
        //忽略檔
        node_modules
        .env
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10241730"> gitignore</a>
      </li>
    </ul>
    <hr>

    <h2>npm difference add and install</h2>
    <p>install和add是別名</p>
    <p>npm5 --save 會自動存</p>
    <pre class="prettyprint">
      <xmp>
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://stackoverflow.com/questions/51466746/difference-between-npm-add-and-npm-install-save">difference add and install</a>
      </li>
    </ul>
    <hr>

    <h2>npm package.json 初始化</h2>
    <p>package.json 不可以用 //來當備註</p>
    <pre class="prettyprint">
      <xmp>
        //初始化
        npm init / npm i

        //package.json
        {
          "name": "crawler",// 專案名稱，全部小寫，不允許空格
          "version": "0.0.1",// 須符合x.x.x的格式
          "description": "FB & IG 爬蟲30天鐵人文章",//專案描述
          "author": "dean lin",//作者名字
          "dependencies": {},//在正式環境中會用到的pacakge
          "devDependencies": {},//在開發、測試環境中會用到的pacakge
          "scripts": {},//你可以撰寫支援的command作爲腳本
          "main": "index.js",//入口檔案
          "license": "MIT",//MIT要放版權說明,ISC和BSD相同,BSD代码鼓励代码共享
        }

        //scripts(腳本) 執行程式
        "scripts": {
          "script名稱": "你要執行的command(指令)",
          "script名稱2": "你要執行的command(指令)",
          ...
        },
        //輸入指令 yarn clean_start 就能執行
        "scripts": {
          //執行內容：移除local端套件→重新安裝套件→更新套件→根據開發環境執行
          "clean_start": "rm -rf node_modules package-lock.json .nuxt yarn.lock yarn-error.log && yarn && yarn upgrade && yarn dev"
        },


      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10239752">初始化 package.json</a>
      </li>
    </ul>
    <hr>

    <h2>npm dotenv 環境變數</h2>
    <pre class="prettyprint">
      <xmp>
        //terminal
        npm i dotenv

        //新增.env檔，建立環境變數
        YOUR_VARIABLE='這是環境變數'

        //在js引入環境變數
        require('dotenv').config(); //載入.env環境檔
        function getEnvVariable () {
            const env_variable= process.env.YOUR_VARIABLE // 取出環境變數
            console.log(env_variable)
        }
        getEnvVariable()
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10241057">使用環境變數</a>
      </li>
    </ul>
    <hr>

    <h2>npm 爬蟲套件</h2>
    <p>request & cheerio</p>
    <p>selenium-webdriver</p>
    <p>Puppeteer</p>
    <pre class="prettyprint">
      <xmp>
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10241791">爬蟲套件</a>
      </li>
    </ul>
    <hr>

    <h2>npm selenium-webdriver</h2>
    <p>chrome版本=>chrome://settings/help貼到你的網址列</p>
    <p>下載chromedriver與你chrome版本相同=>https://chromedriver.chromium.org/downloads</p>
    <p>chromedriver.zip=>chromedriver.exe放到根目錄底下</p>
    <p>.gitignore 忽略 chromedriver.exe 不須上傳</p>
    <pre class="prettyprint">
      <xmp>
        //js
        require('dotenv').config(); //載入.env環境檔
        const webdriver = require('selenium-webdriver') // 加入虛擬網頁套件
        async function openCrawlerWeb() {
          // 建立這個browser的類型
          let driver = await new webdriver.Builder().forBrowser("chrome").build();
          const web = 'https://www.google.com/';//填寫你想要前往的網站
          driver.get(web)//透國這個driver打開網頁
        }
        openCrawlerWeb()//打開爬蟲網頁
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10241791">selenium-webdriver</a>
      </li>
      <li>
        <a href="https://www.cnblogs.com/fnng/p/5854875.html">avaScript（Node.js）+ Selenium自动化测试</a>
      </li>
      <li>
        <a href="https://blog.clarence.tw/2021/06/07/selenium-uses-node-js-to-open-chrome-edge-firefox-for-automatic-control/">Selenium 使用 Node.js 開啟 Chrome, Edge, Firefox 做自動控制</a>
      </li>
      <li>
        <a href="https://www.selenium.dev/selenium/docs/api/javascript/page/Changes.html">官網</a>
      </li>
    </ul>
    <hr>

    <h2>npm selenium-webdriver notification</h2>
    <p>通知 的英文為 notification</p>
    <pre class="prettyprint">
      <xmp>
        //js
        require('dotenv').config(); //載入.env環境檔
        const webdriver = require('selenium-webdriver') // 加入虛擬網頁套件
        async function openCrawlerWeb() {
          // 建立這個browser的類型
          let driver = await new webdriver.Builder().forBrowser("chrome").build();
          const web = 'https://www.google.com/';//填寫你想要前往的網站
          driver.get(web)//透國這個driver打開網頁
        }
        openCrawlerWeb()//打開爬蟲網頁
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10241791">selenium-webdriver</a>
      </li>
      <li>
        <a href="https://www.cnblogs.com/fnng/p/5854875.html">avaScript（Node.js）+ Selenium自动化测试</a>
      </li>
      <li>
        <a href="https://blog.clarence.tw/2021/06/07/selenium-uses-node-js-to-open-chrome-edge-firefox-for-automatic-control/">Selenium 使用 Node.js 開啟 Chrome, Edge, Firefox 做自動控制</a>
      </li>
      <li>
        <a href="https://www.selenium.dev/selenium/docs/api/javascript/page/Changes.html">官網</a>
      </li>
      <li>
        <a href="https://www.selenium.dev/zh-cn/documentation/webdriver/getting_started/first_script/">编写第一个Selenium脚本</a>
      </li>
    </ul>
    <hr>



    <h2>npm selenium-webdriver notification</h2>
    <p>通知 的英文為 notification</p>
    <pre class="prettyprint">
      <xmp>
        //js
     
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://www.selenium.dev/zh-cn/documentation/webdriver/getting_started/first_script/">编写第一个Selenium脚本</a>
      </li>
    </ul>


    <h2>echarts 圖表</h2>
    <h3>ECharts关于y轴刻度调整</h3>
    <p></p>
    <pre class="prettyprint">
      <xmp>
        1.
        min:0,  //取0为最小刻度
        max: 100, //取100为最大刻度

        2.
        min:'dataMin', //取最小值为最小刻度
        max: 'dataMax', //取最大值为最大刻度

        3.
        min: function(value) {//取最小值向下取整为最小刻度
            return Math.floor(value.min)
        },
        max: function(value) {//取最大值向上取整为最大刻度
            return  Math.ceil(value.max) 
        },

        4.
        scale: true, //自适应
        minInterval: 0.1, //分割刻度
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://www.jianshu.com/p/34351adb4fc0">ECharts关于y轴刻度调整</a>
      </li>
      <li>
        <a href="https://echarts.apache.org/zh/option.html#dataZoom-slider">echarts 中文</a>
      </li>
    </ul>


    <h2>同時運行Node.js服務器和Apache服務器</h2>
    <h3>1.在Apache->httpd.conf 加入ProxyPass</h3>
    <p>/stock2/會轉成->http://localhost:3000/</p>
    <p>/stock2/多個斜線因為後面會有接值</p>
    <pre class="prettyprint">
      <xmp>
        ProxyPass /stock2/ http://localhost:3000/
      </xmp>
    </pre>
    <h3>2.刪除註釋</h3>
    <pre class="prettyprint">
      <xmp>
        LoadModule proxy_module modules/mod_proxy.so
        LoadModule proxy_http_module modules/mod_proxy_http.so
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://medium.com/@chamiperera95/how-to-run-node-js-server-and-apache-server-together-ee225ece6a44">參考</a>
      </li>
      <li>
        <a href="https://blog.csdn.net/u011277123/article/details/77165137">參考</a>
      </li>
    </ul>
    <hr>


    <h2>爬蟲 用 request + cheerio</h2>
    <h3>安裝</h3>
    <pre class="prettyprint">
      <xmp>
        npm install request cheerio
      </xmp>
    </pre>
    <h3>一般網站的防爬蟲機制</h3>
    <p>直接偵測requests的header</p>
    <pre class="prettyprint">
      <xmp>
        headers:{'user-agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36'}
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://andy6804tw.github.io/2018/02/11/nodejs-crawler/">[Node.js 爬蟲] 用 request + cheerio 抓取地震資訊</a>
      </li>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10191165">html檔的取得及常見問題</a>
      </li>
    </ul>
    <hr>


    <h2>npm yahoo-finance 抓取股票</h2>
    <h3>1.安裝</h3>
    <pre class="prettyprint">
      <xmp>
        npm install --save yahoo-finance
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://www.npmjs.com/package/yahoo-finance">yahoo-finance</a>
      </li>
    </ul>
    <hr>


    <h2>npm Express</h2>
    <p>Express前後端網頁框架</p>
    <h3>1.安裝</h3>
    <pre class="prettyprint">
      <xmp>
        npm install express --save
      </xmp>
    </pre>
    <h3>2.路由</h3>
    <h3>3.middleware</h3>
    <h3>4.載入靜態檔案 static</h3>
    <pre class="prettyprint">
      <xmp>
        <!-- express 的靜態方法去找到要呈現的靜態檔案。需加上這一段 -->
        app.use(express.static('public'));
      app.get("/", (req, res) => {
        res.send("
        <h1>這是 middleware 練習</h1>
        "+ "
        <img src="./images/book.jpg">
        ");
      });
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10308430">Node.js - Express.js 介紹與起手式</a>
      </li>
    </ul>
    <hr>


    <h2>npm EJS</h2>
    <p>是一個簡易的模板語法</p>
    <h3>安裝</h3>
    <pre class="prettyprint">
      <xmp>
        npm i -D ejs
        npm i -D ejs-locals
      </xmp>
    </pre>
    <h3>引入EJS</h3>
    <pre class="prettyprint">
      <xmp>
        <!-- EJS 核心 -->
        const engine = require("ejs-locals");
      app.engine("ejs", engine);
        <!-- 讀取 EJS 檔案位置 -->
        app.set('views','./views');
        <!-- 用 EJS 引擎跑模板 -->
        app.set("view engine", "ejs");
        <!-- 引入 index.ejs -->
        app.get("/", (req, res) => {
        res.render("index");
      });
      </xmp>
    </pre>
    <h3>將JSON對像傳遞給模板之前，您需要將其轉換回字符串</h3>
    <pre class="prettyprint">
      <xmp>
        var str = JSON.parse('[{"name":"bill", "age":"26"}, {"name":"jeff", "age":"32"}]');
        app.get('/data', function(req, res){
            res.render('data', { str: JSON.stringify(str) });
        });
      </xmp>
    </pre>
    <h3>將JSON對像轉換字符串存才能存在js，之後再轉對像使用</h3>
    <pre class="prettyprint">
      <xmp>
        JSON.parse('<%- JSON.stringify(data) %>').forEach(d=>creatStrockHtml(d))
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10308702">Node.js - EJS 介紹與起手式</a>
      </li>
      <li>
        <a href="https://medium.com/web-design-zone/ejs%E6%A8%A3%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F-40873ea2dfae" target="_blank">Node.js — EJS樣板引擎的使用方式</a>
      </li>
      <li>
        <a href="https://stackoverflow.com/questions/47066222/can-i-render-json-parse-data-to-ejs" target="_blank">將 JSON 數據渲染到 EJS 嗎？</a>
      </li>
      <li>
        <a href="https://ejs.co/" target="_blank">EJS</a>
      </li>
    </ul>
    <hr>

    <h2>npm cron 排程任務的工具 </h2>
    <h3>安裝</h3>
    <pre class="prettyprint">
      <xmp>
        npm install cron
      </xmp>
    </pre>
    <h3>官方範例</h3>
    <pre class="prettyprint">
      <xmp>
        var CronJob = require('cron').CronJob;
        var job = new CronJob('* * * * * *', function() {
            console.log('You will see this message every second');
        }, null, true, 'America/Los_Angeles');
        job.start();
      </xmp>
    </pre>
    <h3>api 架構</h3>
    <pre class="prettyprint">
      <xmp>
        constructor(cronTime, onTick, onComplete, start, timezone, context, runOnInit, unrefTimeout)
        cronTime [必填] 設定定時任務時間
        onTick [必填] 定時任務要執行的函式
        onComplete [選填] 完成定時任務後要執行的函式
        Start [選填] 是否自動啟動job，默認為false
        timeZone [選填] - 指定執行的時區
      </xmp>
    </pre>
    <h3>cronTime 語法</h3>
    <pre class="prettyprint">
      <xmp>
        //每秒都執行
        * * * * * *

        //每分鐘的第 10 秒執行
        10 * * * * *

        //每天晚上 10點30分10秒時執行
        10 30 22 * * *
      </xmp>
    </pre>
    <h3>調整 package.json，建立專門跑排程的 scripts</h3>
    <pre class="prettyprint">
      <xmp>
        start : mac 執行單次爬蟲時使用的
        win_start : windows 執行單次爬蟲時使用的(需要將單引號與雙引號反過來，因為 windows 只會將單引號內的資訊印除來而不會去執行)
        cron : mac、windows 排程執行爬蟲時使用的
        
        "scripts": {
          "start": "node  -e 'require(\"./index\").crawler()'",
          "win_start": "node  -e \"require('./index').crawler()\"",
          "cron":"node tools/cron.js"
        }
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10295841"> 設定排程任務的工具 - node-cron</a>
      </li>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10249462">排程 - Cron套件超詳解，讓爬蟲自己動起來</a>
      </li>
      <li>
        <a href="https://www.zeitverschiebung.net/en/">時區代碼參考網站</a>
      </li>
    </ul>
    <hr>


    <h2>npm mysql</h2>
    <h3>sql datetime to node.js</h3>
    <p>sql時間轉換</p>
    <pre class="prettyprint">
      <xmp>
        var datee = new Date('dateTime');
      console.log(
        datee.getFullYear()+'-'+
        ('0'+(datee.getMonth()+1)).slice(-2)+'-'+
        ('0'+datee.getDate()).slice(-2)+' '+
        ('0'+(datee.getHours())).slice(-2)+':'+
        ('0'+(datee.getMinutes())).slice(-2)+':'+
        ('0'+(datee.getSeconds())).slice(-2)
      );
      </xmp>
    </pre>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://stackoverflow.com/questions/62120309/sql-datetime-to-nodejs">SQL DATETIME to Nodejs</a>
      </li>
    </ul>
    <hr>


    <h2>Node.js-Express+MySQL</h2>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://ithelp.ithome.com.tw/articles/10237562">參考</a>
      </li>
      <li>
        <a href="https://www.youtube.com/watch?v=f5kye3ESXE8&ab_channel=Raddy">參考</a>
      </li>
      <li>
        <a href="https://dotblogs.com.tw/explooosion/2016/07/18/010601">參考</a>
      </li>
    </ul>
    <hr>



    <h2>未實現</h2>
    <p>股票回測</p>
    <p>KD圖表</p>
  </body>
</html>
